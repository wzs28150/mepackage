(function(e) {
  var b = "1.4.10",
    f = {
      exclude: [],
      excludeWithin: [],
      offset: 0,
      onclass: "on",
      direction: "top",
      scrollElement: null,
      scrollTarget: null,
      beforeScroll: function() {},
      afterScroll: function() {},
      easing: "swing",
      speed: 400,
      autoCoefficent: 2
    },
    d = function(i) {
      var j = [],
        h = false,
        g = i.dir && i.dir == "left" ? "scrollLeft" : "scrollTop";
      this.each(function() {
        if (this == document || this == window) {
          return
        }
        var k = e(this);
        if (k[g]() > 0) {
          j.push(this)
        } else {
          k[g](1);
          h = k[g]() > 0;
          if (h) {
            j.push(this)
          }
          k[g](0)
        }
      });
      if (!j.length) {
        this.each(function(k) {
          if (this.nodeName === "BODY") {
            j = [this]
          }
        })
      }
      if (i.el === "first" && j.length > 1) {
        j = [j[0]]
      }
      return j
    },
    a = "ontouchend" in document;
  e.fn.extend({
    scrollable: function(g) {
      var h = d.call(this, {
        dir: g
      });
      return this.pushStack(h)
    },
    firstScrollable: function(g) {
      var h = d.call(this, {
        el: "first",
        dir: g
      });
      return this.pushStack(h)
    },
    smoothScroll: function(g) {
      g = g || {};
      var h = e.extend({}, e.fn.smoothScroll.defaults, g),
        i = e.smoothScroll.filterPath(location.pathname);
      this.unbind("click.smoothscroll").bind("click.smoothscroll", function(k) {
        var s = this,
          p = e(this),
          q = h.exclude,
          m = h.excludeWithin,
          u = 0,
          n = 0,
          j = true,
          t = {},
          l = ((location.hostname === s.hostname) || !s.hostname),
          r = h.scrollTarget || (e.smoothScroll.filterPath(s.pathname) || i) === i,
          o = c(s.hash);
        p.siblings("a").removeClass(h.onclass);
        p.addClass(h.onclass);
        if (!h.scrollTarget && (!l || !r || !o)) {
          j = false
        } else {
          while (j && u < q.length) {
            if (p.is(c(q[u++]))) {
              j = false
            }
          }
          while (j && n < m.length) {
            if (p.closest(m[n++]).length) {
              j = false
            }
          }
        }
        if (j) {
          k.preventDefault();
          e.extend(t, h, {
            scrollTarget: h.scrollTarget || o,
            link: s
          });
          e.smoothScroll(t)
        }
      });
      return this
    }
  });
  e.smoothScroll = function(n, q) {
    var g, l, p, j, r = 0,
      k = "offset",
      m = "scrollTop",
      o = {},
      h = {},
      i = [];
    if (typeof n === "number") {
      g = e.fn.smoothScroll.defaults;
      p = n
    } else {
      g = e.extend({}, e.fn.smoothScroll.defaults, n || {});
      if (g.scrollElement) {
        k = "position";
        if (g.scrollElement.css("position") == "static") {
          g.scrollElement.css("position", "relative")
        }
      }
    }
    g = e.extend({
      link: null
    }, g);
    m = g.direction == "left" ? "scrollLeft" : m;
    if (g.scrollElement) {
      l = g.scrollElement;
      r = l[m]()
    } else {
      l = e("html, body").firstScrollable()
    }
    g.beforeScroll.call(l, g);
    p = (typeof n === "number") ? n : q || (e(g.scrollTarget)[k]() && e(g.scrollTarget)[k]()[g.direction]) || 0;
    o[m] = p + r + g.offset;
    j = g.speed;
    if (j === "auto") {
      j = o[m] || l.scrollTop();
      j = j / g.autoCoefficent
    }
    h = {
      duration: j,
      easing: g.easing,
      complete: function() {
        g.afterScroll.call(g.link, g)
      }
    };
    if (g.step) {
      h.step = g.step
    }
    if (l.length) {
      l.stop().animate(o, h)
    } else {
      g.afterScroll.call(g.link, g)
    }
  };
  e.smoothScroll.version = b;
  e.smoothScroll.filterPath = function(g) {
    return g.replace(/^\//, "").replace(/(index|default).[a-zA-Z]{3,4}$/, "").replace(/\/$/, "")
  };
  e.fn.smoothScroll.defaults = f;

  function c(g) {
    return g.replace(/(:|\.)/g, "\\$1")
  }
})(jQuery);
